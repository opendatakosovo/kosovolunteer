<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Kosovo Volunters</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
     <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
    
    <!-- Bootstrap  JavaScript -->
    <script type="text/javascript" src="{{ url_for('static', filename='bootstrap/js/bootstrap.js') }}"></script>
    <!-- Bootstrap compiled and minified CSS -->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='bootstrap/css/bootstrap.css') }}" />
    <script type="text/javascript">

  
          
          var eventi="";

          function registerEvent(){
              var url = '/create/event';
              var name = $('#txt_name').val();
              var description = $('#txt_description').val();
              var applicants = $('#nr_applicants').val();

              //building dictionary with values from inputs
              var arr_data = {"name": name,
                      "description": description,
                      "applicants": applicants};

              //Converting the dictionary to Json_Document
              var data = JSON.stringify(arr_data);
              
              //Making a post request in url with data converted to json
              $.ajax({
                  type: 'POST',
                  url: url,
                  dataType: 'json',
                  contentType: 'application/json',
                  data: data,

              })

              $(".modal-content").modal("hide");
          }
          function eventId(event){
                eventi = event;
              }

          function registerVolunteer(event_id){
              var url = "/register/volunteer";
              var name = $('#txt_nameapply').val();
              var email = $('#txt_email').val();
              var eventID = eventi;

              var arr_data = {
                              "eventID": eventID,
                              "name": name,
                              "e-mail": email
                            };

            //Converting the dictionary to Json_Document
            var data = JSON.stringify(arr_data);
            
              //Making a post request in url with data converted to json
                $.ajax({
                    type: 'POST',
                    url: url,
                    dataType: 'json',
                    contentType: 'application/json',
                    data: data
                  })
              }
              
        </script>

  </head>
  <body>

    <div class="navbar navbar-default">
        <div class="navbar-header">
          <a class="navbar-brand" href="#">Kosovo Volunters</a>
        </div>
    </div>



    <div class="container">
            
            <div class="row text-center">
               
                <a href="#" class="btn btn-primary" data-toggle="modal" data-target="#basicModal">Register Event</a>
            </div>
    </di>


    <div class="modal fade" id="basicModal" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">Register Event</h4>
      
              </div>
              <div class="modal-body">
                <form class="form-horizontal">
              <fieldset>
                
                <div class="form-group">
                  <label  class="col-lg-2">Name</label>
                  <div class="col-lg-10">
                    <input type="text" class="form-control" id="txt_name">
                  </div>
                </div>
              
                <div class="form-group">
                  <label for="textArea" class="col-lg-2 control-label">Description</label>
                  <div class="col-lg-10">
                    <textarea class="form-control" rows="3" id="txt_description"></textarea>
                    <span class="help-block">A longer block of help text that breaks onto a new line and may extend beyond one line.</span>
                  </div>
                </div>
                <div class="form-group">
                  <label  class="col-lg-2">Needed volunters</label>
                  <div class="col-lg-10">
                    <input type="text" class="form-control" id="nr_applicants">
                  </div>
                </div>
          
                
              </fieldset>
            </form>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" id="btn_save" class="btn btn-primary" onclick="javascript:registerEvent()" data-dismiss="modal" >Register</button>
              </div>
            </div>
          </div>
    </div>

    <hr>

    <div id="display_events">
     {% for item in result %}
        <table class="table table-striped table-hover ">
          <thead>
            <tr>
              <th> EventId</th>
              <th>Name</th>
              <th>Description</th>
              <th>Needed volunters</th>

              <th>Number Applicants</th>

            </tr>
          </thead>
          <tbody>
            <tr>
              <td>{{item['_id']['$oid']}}</td>
            
              <td>{{ item['name'] }}</td>
                                  
              <td>{{item['description']}}</td>
                                
              <td id="txt_NrApp">{{item['applicants']}}</td>

              {% for item1 in result1 %}
              {% if item1['eventId'] == item['_id']['$oid'] %}
              <td id ="txt_Numri">{{item1['Numri']}}</td>
           

              {% endif %}
              {% endfor %}
                 <td> 
                <button type="button" id="btn_apply_event" class="btn btn-primary" data-toggle="modal" data-target="#smallModal" onclick="javascript:eventId('{{item['_id']['$oid']}}');">Apply</button>

              
              </td>
            
            </tr>                      
                        
          </tbody>

    </table>

    {% endfor %}

    </div>


    <div class="modal fade" id="smallModal" tabindex="-1" role="dialog" aria-labelledby="smallModal" aria-hidden="true">
          <div class="modal-dialog modal-sm">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">Apply as volunteer</h4>
              </div>
              <div class="modal-body">
                <form class="form-horizontal">
                <fieldset>
                  <div class="form-group">
                   <label class="col-lg-2">Name</label>
                    <div class="col-lg-10">
                     <input type="text" class="form-control" id="txt_nameapply">
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="inputEmail" class="col-lg-2 control-label">Email</label>
                    <div class="col-lg-10">
                      <input type="text" class="form-control" id="txt_email" placeholder="Email">
                    </div>
                  </div>
                </fieldset>
                </form>
              </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            <button type="button" id="btn_apply" class="btn btn-primary" onclick="javascript:registerVolunteer();" data-dismiss="modal">Apply</button>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>  