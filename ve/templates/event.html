<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Kosovo Volunters</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

   
     <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
    
    <!-- Bootstrap  JavaScript -->
    <script type="text/javascript" src="{{ url_for('static', filename='bootstrap/js/bootstrap.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='bootstrapvalidator/dist/js/bootstrapValidator.js') }}"></script>
    
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='bootstrap/css/bootstrap.css') }}" />
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='bootstrapvalidator/dist/css/bootstrapValidator.css') }}">
    <script type="text/javascript">
    

          var eventi="";

          function registerEvent(){
              var url = '/create/event';
              var name = $('#txt_name').val();
              var description = $('#txt_description').val();
              var applicants = $('#nr_applicants').val();
              var image = $('#image').val();

              //building dictionary with values from inputs
              var arr_data = {"name": name,
                      "description": description,
                      "applicants": applicants,
                      "image" : image
                      };

              //Converting the dictionary to Json_Document
              var data = JSON.stringify(arr_data);
              
              //Making a post request in url with data converted to json
              $.ajax({
                  type: 'POST',
                  url: url,
                  dataType: 'json',
                  contentType: 'application/json',
                  data: data,

              })
              window.location.href = '/'
            
          }
          function eventId(event){
                eventi = event;
              }

          function registerVolunteer(event_id){
              var url = "/register/volunteer";
              var name = $('#txt_nameapply').val();
              var email = $('#txt_email').val();
              var eventID = eventi;
              var lastname = $('#txt_lastname').val();
              var phone =$('#phone_nr').val();

              var arr_data = {
                              "eventID": eventID,
                              "name": name,
                              "e-mail": email,
                              "lastname":lastname,
                              "phone":phone
                            };

            //Converting the dictionary to Json_Document
            var data = JSON.stringify(arr_data);
            
              //Making a post request in url with data converted to json
                $.ajax({
                    type: 'POST',
                    url: url,
                    dataType: 'json',
                    contentType: 'application/json',
                    data: data
                  })
                window.location.href = '/'
              }
        $(document).ready(function(){
          $('.sign-up').bootstrapValidator({
            feedbackIcons: {
            valid: 'glyphicon glyphicon-ok',
            invalid: 'glyphicon glyphicon-remove',
            validating: 'glyphicon glyphicon-refresh'
          },
          fields: {
            Name: {
                validators: {
                  notEmpty : {
                    message: 'Please fill the field'
                 }
                  
                }
            },
            Numri: {
                    validators: {
                        notEmpty: {
                            message: 'Please fill the field'
                        },
                        integer: {
                            message: 'The type must be a number'
                        }
                    }
                },

            Email: {
                validators: {
                    notEmpty: {
                        message: 'Please fill the field'
                    },
                    emailAddress: {
                        message: 'The input is not a valid email address'
                    }
                }
            }  
        }
                      
       });
     });


  </script>

  </head>
  <body>
    <div class="container">
            
            <div class="row text-center">
               
                <a href="#" class="btn btn-primary" data-toggle="modal" data-target="#basicModal">Create Event</a>
            </div>
    </div>


    <div class="modal fade" id="basicModal" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">Create Event</h4>
      
              </div>
              <div class="modal-body">
                <form class='sign-up'>
              <fieldset>
                
                <div class="form-group">
                  <label class="col-lg-2 control-label">Name</label>
                 
                  <div class="controls col-lg-10 ">
                  <p><input type="text" class="form-control" id="txt_name" name="Name"></p>
                  
                  </div>
                </div>

              
                <div class="form-group">
                  <label for="textArea" class="col-lg-2 control-label">Description</label>
                  <div class="controls col-lg-10">
                    <p><textarea class="form-control" rows="3" id="txt_description" name="Name"></textarea></p>
                    
                  </div>
                </div>
                <div class="form-group">
                  <label  class="col-lg-5">Number of needed volunteers</label>
                  <div class="controls col-lg-7">
                    <p><input type="number" class="form-control" id="nr_applicants" name="Numri"></p>
          
                  </div>
                </div>
            

                 <div class="form-group">
                  <label for="image" class="col-lg-2 control-label">Image</label>
                  <div class="controls col-lg-10">
                     <input type="url" class=" form-control" id="image">
                     
                  </div>
                </div>


              </fieldset>
            </form>
      </div>
              <div class="modal-footer">
                
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" id="btn_save" class="btn btn-primary" onclick="javascript:registerEvent();" data-dismiss="modal" >Create</button>
              </div>
            </div>
          </div>
    </div>
    <hr>
    <div id="display_events">
     {% for item in DisplayEvents %}
        <table class="table table-striped table-hover ">
          <thead>
            <tr>
              <th>Name</th>
              <th>Description</th>
              <th>Needed volunters</th>
              <th>Number Applicants</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>{{ item['name'] }}</td>
                                  
              <td>{{item['description']}}</td>
                                
              <td id="txt_NrApp">{{item['applicants']}}</td>

              {% for item1 in DisplayVolunter %}
              {% if item1['eventId'] == item['_id']['$oid'] %}
              <td id ="txt_Numri">{{item1['Numri']}}</td>
           

              {% endif %}
              {% endfor %}
                 <td> 
                <button type="button" id="btn_apply_event" class="btn btn-primary" data-toggle="modal" data-target="#smallModal" onclick="javascript:eventId('{{item['_id']['$oid']}}');">Apply</button>

              
              </td>
            
            </tr>                            
          </tbody>
    </table>

    {% endfor %}

    </div>

    <div class="modal fade" id="smallModal" tabindex="-1" role="dialog" aria-labelledby="smallModal" aria-hidden="true">
          <div class="modal-dialog modal-sm">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">Apply as volunteer</h4>
              </div>
              <div class="modal-body">
                <form class="sign-up">
                <fieldset>

                  <div class="form-group">
                   <label class="col-lg-5">First Name</label>
                    <div class="col-lg-7">
                     <p><input type="text" class="form-control" id="txt_nameapply" name="Name"><p>
                    </div>
                  </div>

                  <div class="form-group">
                   <label class="col-lg-5">Last Name</label>
                    <div class="col-lg-7">
                     <p><input type="text" class="form-control" id="txt_lastname" name="Name"></p>
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="inputEmail" class="col-lg-2 control-label">Email</label>
                    <div class="col-lg-10">
                      <p><input type="text" class="form-control" id="txt_email" placeholder="Email" name="Email"></p>
                    </div>
                  
                  </div>
                    <div class="form-group">
                   <label class="col-lg-6">Phone Number</label>
                    <div class="col-lg-6">
                     <p><input type="text" class="form-control" id="phone_nr" name="Numri"></p>
                    </div>
                  </div>

                </fieldset>
                </form>
              </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            <button type="button" id="btn_apply" class="btn btn-primary" onclick="javascript:registerVolunteer();" data-dismiss="modal">Apply</button>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>  